#!/usr/bin/env python3

## Based on https://guardicore.zendesk.com/hc/en-us/articles/360015818659-HOWTO-Network-Logs-API-Endpoint-Guide

import config.default_config as default_cfg
import config.version as gc_version
import modules.argsParser as args
import modules.generic as generic
import modules.aka_log as aka_log
import modules.events as events

my_args = args.init()

if my_args.version:
    generic.version()

# Load the LOG system
aka_log.init(my_args.loglevel, gc_version.__tool_name_short__)


# Pre Flight checks
edgerc_data = generic.edgerc_reader(configfile=my_args.credentials_file,
                      configsection=my_args.credentials_file_section,
                      configvalues=["gc_username","gc_password","gc_hostname"])

#if my_args.netlog:
#    .netlog()

print(generic.gc_get_auth_token(gc_username=edgerc_data['gc_username'], gc_password=edgerc_data['gc_password'], gc_hostname=edgerc_data['gc_hostname']))